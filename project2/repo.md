# Project2: implement length extension attack for SM3

`实验报告  `

## sm3.py

基于《SM3密码杂凑算法》官方文档自主实现了sm3算法

## attack.py

### 问题场景

早期人们利用哈希函数构造消息验证码的方法是，将密钥$k$和消息直接并联后计算哈希值，即$\text{Mac}_k(m)=H(k||m)$。但是这一签名方案并不是安全的，我们可以利用哈希长度扩展攻击，在未知签名密钥$k$的情况下，构造合法的签名伪造。

在本项目我将上述攻击实例化到MD结构的哈希函数`sm3`上，完成上述的攻击。

### 代码思想

敌手获得消息$m'=Best wishes!$的签名$s'$，试图在不知道密钥$k$的情况下，在消息后附加任意拓展的消息，伪造它的签名值。

#### 敌手攻击

首先，敌手模拟SM3的消息填充过程，将$m'$进行填充至512bit的倍数。计算此时的字节长度$len'$。将$m'$后追加攻击字符串"attack!"，对整个字符串进行SM3的消息填充（消息长度为$len('attack!')+len'$）。如有必要，对消息进行分组。

然后，将收到的哈希$s'$作为“IV”，对消息进行哈希。即可伪造出追加消息后的哈希值（签名值）。

#### 验签

check_res(extend_msg,hash_res)函数

该函数模仿了拥有私钥的一方，验证签名的过程。作为本实验正确性的检验。